# 開発計画書 - 材料データベース × 元素周期表 × デザインリサーチ統合

## 📋 プロジェクト前提（絶対条件）

### 絶対条件
1. **一度に全部を実装しない** - 各ステップで「壊れない・動く」状態を維持
2. **著作権・ライセンス遵守** - 曖昧なデータ・画像は使用しない
3. **UI・データ・ロジックの分離** - 保守性と拡張性を確保
4. **将来の拡張性** - 材料増加・教育・研究用途への対応を前提に設計

## 🎯 最終ゴール

1. **元素周期表から検索できるページを持つ**
2. **118元素すべてを権利的に安全なデータでカード化**
3. **材料カードに3タブ構造を持たせる**
   - 材料物性
   - 入手先・用途
   - 歴史・物語
4. **将来的に「材料が元素周期表のどこに位置づくか」を視覚的にマッピング可能な構造を持つ**

## 🎯 統合目標

```
材料データベース × 元素周期表 × デザインリサーチ
```

## 📊 現在の実装状況

### ✅ 実装済み
- [x] 材料データベース（SQLite、詳細な材料情報）
- [x] Streamlit UI（WOTA風デザイン）
- [x] 素材カード生成（HTML形式）
- [x] 画像生成（PIL使用、著作権フリー）
- [x] 材料登録フォーム（詳細仕様対応）
- [x] 検索・フィルタリング機能
- [x] ダッシュボード（統計・可視化）

### ⏳ 未実装
- [ ] 元素周期表統合
- [ ] デザインリサーチ機能
- [ ] 材料と元素の関連付け
- [ ] 元素組成の可視化

## 🗺️ 段階的実装計画

### Phase 1: 材料カードの3タブ構造実装（優先度：高）
**目標**: 材料カードに3タブ構造を実装（既存機能を壊さない）

#### ステップ1.1: データベース拡張（歴史・物語データ）
- [ ] `MaterialHistory` テーブルの追加（既存テーブルに影響なし）
  - `material_id` (Foreign Key)
  - `history_story` (歴史・物語、Text)
  - `procurement_info` (入手先情報、Text)
  - `use_cases` (用途情報、Text)
- [ ] マイグレーションスクリプトの作成

#### ステップ1.2: 材料カードUIの3タブ化
- [ ] `show_material_cards()` 関数を3タブ構造に変更
  - タブ1: 材料物性（既存の物性データ表示）
  - タブ2: 入手先・用途（新規）
  - タブ3: 歴史・物語（新規）
- [ ] 既存の表示機能が壊れないことを確認

**検証**: 3タブ構造が正しく表示され、既存機能が動作することを確認

---

### Phase 2: 118元素のカード化（安全・段階的）
**目標**: 118元素すべてを権利的に安全なデータでカード化

#### ステップ2.1: 元素データの準備（著作権フリー）
- [ ] 元素周期表データの作成（IUPAC標準データ、パブリックドメイン）
  - 元素記号、原子番号、原子量、周期、族、分類など
  - 118元素すべての基本情報
- [ ] `periodic_table.py` モジュールの作成
  - 元素データの読み込み
  - 元素情報の取得関数
  - 元素カード生成関数

#### ステップ2.2: 元素カードUIの実装
- [ ] Streamlitで元素カードを表示するページ追加
- [ ] 元素周期表から元素を選択してカード表示
- [ ] 各元素の基本情報をカード形式で表示

**検証**: 118元素すべてがカード化され、正しく表示されることを確認

---

### Phase 3: 元素周期表からの検索機能
**目標**: 元素周期表から検索できるページを実装

#### ステップ3.1: 周期表UIの実装
- [ ] Streamlitで周期表を表示するページ追加
- [ ] 周期表のグリッドレイアウト（118元素）
- [ ] 各元素をクリック可能にする

#### ステップ3.2: 検索機能の統合
- [ ] 周期表から元素を選択して検索
- [ ] 選択した元素を含む材料を検索・表示
- [ ] 元素カードと材料カードの連携

**検証**: 周期表から検索が正しく動作することを確認

---

### Phase 4: 材料と元素の関連付け（段階的統合）
**目標**: 材料に含まれる元素を登録・表示できるようにする

#### ステップ4.1: データベース拡張
- [ ] `MaterialElement` テーブルの追加
  - `material_id` (Foreign Key)
  - `element_symbol` (元素記号)
  - `percentage` (含有率、任意)
- [ ] マイグレーションスクリプトの作成

#### ステップ4.2: UI統合
- [ ] 材料登録フォームに元素選択機能を追加
- [ ] 材料詳細ページに元素組成を表示（3タブ構造の「材料物性」タブに追加）
- [ ] 周期表上で材料に含まれる元素をハイライト

**検証**: 材料と元素の関連付けが正しく動作することを確認

---

### Phase 5: 材料の元素周期表マッピング（将来実装）
**目標**: 「材料が元素周期表のどこに位置づくか」を視覚的にマッピング

#### ステップ5.1: マッピングロジック
- [ ] 材料の元素組成から周期表上の位置を計算
- [ ] 複数元素を含む材料のマッピング方法の設計

#### ステップ5.2: 可視化UI
- [ ] 周期表上に材料の位置をマッピング表示
- [ ] 材料と元素の関係を視覚化

**検証**: マッピングが正しく表示されることを確認

---

## 🏗️ アーキテクチャ設計

### モジュール構成（分離原則）

```
app.py                    # UI層（Streamlit）
├── database.py           # データ層（SQLAlchemy）
├── models.py             # データモデル（Pydantic）
├── periodic_table.py     # 元素周期表ロジック（新規）
├── material_service.py   # 材料ビジネスロジック（新規）
├── design_research.py    # デザインリサーチロジック（新規）
├── card_generator.py     # カード生成ロジック
└── image_generator.py    # 画像生成ロジック
```

### データフロー

```
UI (app.py)
  ↓
ビジネスロジック (material_service.py, periodic_table.py)
  ↓
データアクセス (database.py)
  ↓
データベース (SQLite)
```

## 📝 実装ルール

### 1. 各ステップの完了条件
- [ ] コードが動作する
- [ ] 既存機能が壊れていない
- [ ] エラーハンドリングが適切
- [ ] 基本的なテストが通る

### 2. コミット方針
- 各ステップ完了時にコミット
- コミットメッセージに「Phase X, Step X.X」を明記
- 動作確認後にプッシュ

### 3. データソースの選定基準
- パブリックドメインまたは明確なライセンス
- 出典の明記
- 商用利用可能

## 🔍 次のステップ

**Phase 1, Step 1.1 から開始**: 材料カードの3タブ構造実装（既存機能を壊さない安全な実装）

---

## 📚 参考資料

- IUPAC Periodic Table: https://iupac.org/what-we-do/periodic-table-of-elements/
- 元素データ: パブリックドメインの元素周期表データを使用

